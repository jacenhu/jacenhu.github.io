<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TCP/IP详解卷一 | Jacen&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" type="image/x-icon" href="./favicon.ico">
    <link rel="apple-touch-icon" href="./favicon.ico">
    <meta name="description" content="my personal blog">
    
    <link rel="preload" href="/assets/css/0.styles.2888696b.css" as="style"><link rel="preload" href="/assets/js/app.7cef2ded.js" as="script"><link rel="preload" href="/assets/js/2.6425c107.js" as="script"><link rel="preload" href="/assets/js/3.b11b99ee.js" as="script"><link rel="prefetch" href="/assets/js/10.1481c12a.js"><link rel="prefetch" href="/assets/js/11.b64d3f3a.js"><link rel="prefetch" href="/assets/js/12.96e5f91e.js"><link rel="prefetch" href="/assets/js/13.d1468c6a.js"><link rel="prefetch" href="/assets/js/14.b4c40127.js"><link rel="prefetch" href="/assets/js/15.c1c602a7.js"><link rel="prefetch" href="/assets/js/16.7a6d193e.js"><link rel="prefetch" href="/assets/js/17.af99f69e.js"><link rel="prefetch" href="/assets/js/18.cc859287.js"><link rel="prefetch" href="/assets/js/19.15845952.js"><link rel="prefetch" href="/assets/js/20.60a13ab7.js"><link rel="prefetch" href="/assets/js/21.2fa8c7be.js"><link rel="prefetch" href="/assets/js/22.28715219.js"><link rel="prefetch" href="/assets/js/23.41ee1728.js"><link rel="prefetch" href="/assets/js/24.95f7c70f.js"><link rel="prefetch" href="/assets/js/25.93b0634c.js"><link rel="prefetch" href="/assets/js/26.b11b7c9b.js"><link rel="prefetch" href="/assets/js/27.3c5b23a8.js"><link rel="prefetch" href="/assets/js/28.de8f98d1.js"><link rel="prefetch" href="/assets/js/29.1c4c62bb.js"><link rel="prefetch" href="/assets/js/30.09dc3858.js"><link rel="prefetch" href="/assets/js/31.759236ff.js"><link rel="prefetch" href="/assets/js/32.cf88ca34.js"><link rel="prefetch" href="/assets/js/33.539019c1.js"><link rel="prefetch" href="/assets/js/34.cbbf120b.js"><link rel="prefetch" href="/assets/js/35.d1c27a8d.js"><link rel="prefetch" href="/assets/js/36.37ed2443.js"><link rel="prefetch" href="/assets/js/37.c13152c3.js"><link rel="prefetch" href="/assets/js/38.f8ccb31d.js"><link rel="prefetch" href="/assets/js/39.fa955ad2.js"><link rel="prefetch" href="/assets/js/4.85748413.js"><link rel="prefetch" href="/assets/js/40.08282f43.js"><link rel="prefetch" href="/assets/js/41.41671f66.js"><link rel="prefetch" href="/assets/js/42.1a50238c.js"><link rel="prefetch" href="/assets/js/43.095f995a.js"><link rel="prefetch" href="/assets/js/44.6f5eb2ef.js"><link rel="prefetch" href="/assets/js/45.0f2e41f0.js"><link rel="prefetch" href="/assets/js/5.221eefda.js"><link rel="prefetch" href="/assets/js/6.8d9dca1c.js"><link rel="prefetch" href="/assets/js/7.f4f80172.js"><link rel="prefetch" href="/assets/js/8.13fc1817.js"><link rel="prefetch" href="/assets/js/9.a8851229.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2888696b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Jacen's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/program/" class="nav-link router-link-active">
  技术
</a></div><div class="nav-item"><a href="/books/" class="nav-link">
  阅读
</a></div><div class="nav-item"><a href="https://www.zhihu.com/people/jacenhu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  知乎
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/jacenhu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://www.jianshu.com/u/9c488588c366" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://juejin.cn/user/2796746683466984/activities" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/program/" class="nav-link router-link-active">
  技术
</a></div><div class="nav-item"><a href="/books/" class="nav-link">
  阅读
</a></div><div class="nav-item"><a href="https://www.zhihu.com/people/jacenhu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  知乎
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/jacenhu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://www.jianshu.com/u/9c488588c366" target="_blank" rel="noopener noreferrer" class="nav-link external">
  简书
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://juejin.cn/user/2796746683466984/activities" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JAVA后端</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>C++</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/program/cpp/CppPrimer.html" class="sidebar-link">C++ Primer</a></li><li><a href="/program/cpp/dataStructure.html" class="sidebar-link">常用数据结构与算法</a></li><li><a href="/program/cpp/HTTPIP.html" aria-current="page" class="active sidebar-link">TCP/IP详解卷一</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/program/cpp/HTTPIP.html#tcp-ip详解卷一-chapter1-概述" class="sidebar-link">TCP/IP详解卷一 Chapter1 概述</a></li><li class="sidebar-sub-header"><a href="/program/cpp/HTTPIP.html#tcp-ip详解卷一-chapter2-链路层" class="sidebar-link">TCP/IP详解卷一 Chapter2 链路层</a></li><li class="sidebar-sub-header"><a href="/program/cpp/HTTPIP.html#tcp-ip详解卷一-chapter3-ip-网际协议" class="sidebar-link">TCP/IP详解卷一 Chapter3 IP:网际协议</a></li><li class="sidebar-sub-header"><a href="/program/cpp/HTTPIP.html#tcp-ip详解卷一-chapter4-arp-地址解析协议" class="sidebar-link">TCP/IP详解卷一 Chapter4 ARP:地址解析协议</a></li><li class="sidebar-sub-header"><a href="/program/cpp/HTTPIP.html#tcp-ip详解卷一-chapter5-rarp-逆地址解析协议" class="sidebar-link">TCP/IP详解卷一 Chapter5 RARP:逆地址解析协议</a></li><li class="sidebar-sub-header"><a href="/program/cpp/HTTPIP.html#tcp-ip详解卷一-chapter7-ping程序" class="sidebar-link">TCP/IP详解卷一 Chapter7 Ping程序</a></li><li class="sidebar-sub-header"><a href="/program/cpp/HTTPIP.html#tcp-ip详解卷一-chapter17-tcp-传输控制协议" class="sidebar-link">TCP/IP详解卷一 Chapter17 TCP:传输控制协议</a></li><li class="sidebar-sub-header"><a href="/program/cpp/HTTPIP.html#tcp-ip详解卷一-chapter18-tcp连接的建立与终止" class="sidebar-link">TCP/IP详解卷一 Chapter18 TCP连接的建立与终止</a></li><li class="sidebar-sub-header"><a href="/program/cpp/HTTPIP.html#tcp-ip详解卷一-chapter19-tcp的交互数据流" class="sidebar-link">TCP/IP详解卷一 Chapter19 TCP的交互数据流</a></li><li class="sidebar-sub-header"><a href="/program/cpp/HTTPIP.html#tcp-ip详解卷一-chapter20-tcp的成块数据流" class="sidebar-link">TCP/IP详解卷一 Chapter20 TCP的成块数据流</a></li><li class="sidebar-sub-header"><a href="/program/cpp/HTTPIP.html#tcp-ip详解卷一-chapter21-tcp的超时与重传" class="sidebar-link">TCP/IP详解卷一 Chapter21 TCP的超时与重传</a></li></ul></li><li><a href="/program/cpp/Ceph.html" class="sidebar-link">分布式存储系统Ceph</a></li><li><a href="/program/cpp/CppKnowledge.html" class="sidebar-link">C++开发知识点整理</a></li><li><a href="/program/cpp/TCPSummary.html" class="sidebar-link">TCP/IP协议知识总结</a></li><li><a href="/program/cpp/linuxCommand.html" class="sidebar-link">linux系统命令</a></li><li><a href="/program/cpp/Abstract.html" class="sidebar-link">计算机术语概念解释（持续更新）</a></li><li><a href="/program/cpp/vscodeCpp.html" class="sidebar-link">vscode运行C++</a></li><li><a href="/program/cpp/JD.html" class="sidebar-link">从招聘信息看分布式存储需掌握既能</a></li><li><a href="/program/cpp/mempool.html" class="sidebar-link">内存池设计相关参考</a></li><li><a href="/program/cpp/CodingInterviewSummary.html" class="sidebar-link">《剑指offer》小结</a></li><li><a href="/program/cpp/lowCode.html" class="sidebar-link">什么是低代码</a></li><li><a href="/program/cpp/DataLakeWhat.html" class="sidebar-link">什么是数据湖？及其架构</a></li><li><a href="/program/cpp/designPattern.html" class="sidebar-link">23种设计模式（updating）</a></li><li><a href="/program/cpp/ghz_chapter1.html" class="sidebar-link">基于ghz进行gRpc框架性能压测（1）</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>论文</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>实践</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="tcp-ip详解卷一"><a href="#tcp-ip详解卷一" class="header-anchor">#</a> TCP/IP详解卷一</h1> <p></p><div class="table-of-contents"><ul><li><a href="#tcp-ip详解卷一-chapter1-概述">TCP/IP详解卷一 Chapter1 概述</a><ul><li><a href="#_1-1-引言">1.1 引言</a></li><li><a href="#_1-2-分层">1.2 分层</a></li><li><a href="#_1-3互联网的地址">1.3互联网的地址</a></li><li><a href="#_1-5-域名系统">1.5 域名系统</a></li><li><a href="#_1-9-端口">1.9 端口</a></li><li><a href="#_1-13-互联网">1.13 互联网</a></li><li><a href="#_1-15-应用编程接口">1.15 应用编程接口</a></li><li><a href="#_1-17-小结">1.17 小结</a></li></ul></li><li><a href="#tcp-ip详解卷一-chapter2-链路层">TCP/IP详解卷一 Chapter2 链路层</a><ul><li><a href="#_2-1-引言">2.1 引言</a></li><li><a href="#_2-2-以太网和ieee-802封装">2.2 以太网和IEEE 802封装</a></li><li><a href="#_2-3-尾部封装">2.3 尾部封装</a></li><li><a href="#_2-4-slip-串行线路ip">2.4 SLIP：串行线路IP</a></li><li><a href="#_2-5-压缩的slip">2.5 压缩的SLIP</a></li><li><a href="#_2-6-ppp-点对点协议">2.6 PPP ：点对点协议</a></li><li><a href="#_2-7-环回接口">2.7 环回接口</a></li><li><a href="#_2-8-最大传输单元mtu">2.8 最大传输单元MTU</a></li><li><a href="#_2-9-路径mtu">2.9 路径MTU</a></li></ul></li><li><a href="#tcp-ip详解卷一-chapter3-ip-网际协议">TCP/IP详解卷一 Chapter3 IP:网际协议</a><ul><li><a href="#_3-1-引言">3.1 引言</a></li><li><a href="#_3-2-ip首部">3.2 IP首部</a></li><li><a href="#_3-3-ip路由选择">3.3 IP路由选择</a></li><li><a href="#_3-5-子网掩码">3.5 子网掩码</a></li><li><a href="#_3-8-ifconfig-命令">3.8 ifconfig 命令</a></li><li><a href="#_3-9-netstat-命令">3.9 netstat 命令</a></li></ul></li><li><a href="#tcp-ip详解卷一-chapter4-arp-地址解析协议">TCP/IP详解卷一 Chapter4 ARP:地址解析协议</a><ul><li><a href="#_4-1-引言">4.1 引言</a></li><li><a href="#_4-2-一个例子">4.2 一个例子</a></li><li><a href="#_4-3-arp高速缓存">4.3 ARP高速缓存</a></li><li><a href="#_4-4-arp的分组格式">4.4 ARP的分组格式</a></li><li><a href="#_4-6-arp代理">4.6 ARP代理</a></li><li><a href="#_4-7-免费arp">4.7 免费ARP</a></li><li><a href="#_4-8-arp命令">4.8 ARP命令</a></li></ul></li><li><a href="#tcp-ip详解卷一-chapter5-rarp-逆地址解析协议">TCP/IP详解卷一 Chapter5 RARP:逆地址解析协议</a><ul><li><a href="#_5-1-引言">5.1 引言</a></li><li><a href="#_5-2-rarp的分组格式">5.2 RARP的分组格式</a></li><li><a href="#_5-3-rarp举例">5.3 RARP举例</a></li><li><a href="#_5-4-rarp服务器的设计">5.4 RARP服务器的设计</a></li><li><a href="#_5-5-小结">5.5 小结</a></li></ul></li><li><a href="#tcp-ip详解卷一-chapter7-ping程序">TCP/IP详解卷一 Chapter7 Ping程序</a><ul><li><a href="#_7-1-引言">7.1 引言</a></li><li><a href="#_7-2-ping程序">7.2 Ping程序</a></li><li><a href="#_7-3-ip记录路由选项">7.3 IP记录路由选项</a></li><li><a href="#_7-4-ip时间戳选项">7.4 IP时间戳选项</a></li><li><a href="#_7-5-小结">7.5 小结</a></li></ul></li><li><a href="#tcp-ip详解卷一-chapter17-tcp-传输控制协议">TCP/IP详解卷一 Chapter17 TCP:传输控制协议</a><ul><li><a href="#_17-2-tcp的服务">17.2 TCP的服务</a></li><li><a href="#_17-3-tcp的首部">17.3 TCP的首部</a></li><li><a href="#_17-4-小结">17.4 小结</a></li></ul></li><li><a href="#tcp-ip详解卷一-chapter18-tcp连接的建立与终止">TCP/IP详解卷一 Chapter18 TCP连接的建立与终止</a><ul><li><a href="#_18-1-引言">18.1 引言</a></li><li><a href="#_18-2-连接的建立与终止">18.2 连接的建立与终止</a></li><li><a href="#_18-3-连接建立的超时">18.3 连接建立的超时</a></li><li><a href="#_18-4-最大报文段长度">18.4 最大报文段长度</a></li><li><a href="#_18-5-tcp的半关闭">18.5 TCP的半关闭</a></li><li><a href="#_18-6-tcp的状态变迁图">18.6 TCP的状态变迁图</a></li><li><a href="#_18-7-复位报文段">18.7 复位报文段</a></li><li><a href="#_18-8-同时打开">18.8 同时打开</a></li><li><a href="#_18-9-同时关闭">18.9 同时关闭</a></li><li><a href="#_18-10-tcp选项">18.10 TCP选项</a></li><li><a href="#_18-11-tcp服务的设计">18.11 TCP服务的设计</a></li><li><a href="#_18-12-小结">18.12 小结</a></li></ul></li><li><a href="#tcp-ip详解卷一-chapter19-tcp的交互数据流">TCP/IP详解卷一 Chapter19 TCP的交互数据流</a><ul><li><a href="#_19-1-引言">19.1 引言</a></li><li><a href="#_19-2-交互式输入">19.2 交互式输入</a></li><li><a href="#_19-3-经受时延的确认">19.3 经受时延的确认</a></li><li><a href="#_19-4-nagle算法">19.4 Nagle算法</a></li><li><a href="#_19-5-窗口大小通告">19.5 窗口大小通告</a></li><li><a href="#_19-6-小结">19.6 小结</a></li></ul></li><li><a href="#tcp-ip详解卷一-chapter20-tcp的成块数据流">TCP/IP详解卷一 Chapter20 TCP的成块数据流</a><ul><li><a href="#_20-1-引言">20.1 引言</a></li><li><a href="#_20-2-正常数据流">20.2 正常数据流</a></li><li><a href="#_20-3-滑动窗口">20.3 滑动窗口</a></li><li><a href="#_20-4-窗口大小">20.4 窗口大小</a></li><li><a href="#_20-5-push标志">20.5 PUSH标志</a></li><li><a href="#_20-6-慢启动">20.6 慢启动</a></li><li><a href="#_20-7-成块数据的吞吐量">20.7 成块数据的吞吐量</a></li><li><a href="#_20-8-紧急方式">20.8 紧急方式</a></li><li><a href="#_20-9-小结">20.9 小结</a></li></ul></li><li><a href="#tcp-ip详解卷一-chapter21-tcp的超时与重传">TCP/IP详解卷一 Chapter21 TCP的超时与重传</a><ul><li><a href="#_21-1-引言">21.1 引言</a></li><li><a href="#_21-3-往返时间测量">21.3 往返时间测量</a></li><li><a href="#_21-6-拥塞避免算法">21.6 拥塞避免算法</a></li><li><a href="#_21-7-快速重传与快速恢复算法">21.7 快速重传与快速恢复算法</a></li><li><a href="#_21-11-重新分组">21.11 重新分组</a></li><li><a href="#_21-12-小结">21.12 小结</a></li></ul></li></ul></div><p></p> <p><strong>声明:</strong></p> <p>本文为《TCP/IP详解 卷1：协议》学习笔记，原书更为详细，本文仅作学习交流使用。</p> <h2 id="tcp-ip详解卷一-chapter1-概述"><a href="#tcp-ip详解卷一-chapter1-概述" class="header-anchor">#</a> TCP/IP详解卷一 Chapter1 概述</h2> <h3 id="_1-1-引言"><a href="#_1-1-引言" class="header-anchor">#</a> 1.1 引言</h3> <p>TCP/IP协议族被称作“全球互联网”或“因特网(Internet)”的基础。</p> <h3 id="_1-2-分层"><a href="#_1-2-分层" class="header-anchor">#</a> 1.2 分层</h3> <p>TCP/IP通常是四层协议系统。</p> <p>1）链路层。通常包括操作系统中的设备驱动程序和计算机中对应的网络接口卡。</p> <p>2）网络层。处理分组在网络中的活动。包括IP协议，ICMP协议，IGMP协议。</p> <p>3）运输层。为两台主机上的程序提供端到端的通信。有两种不同的协议:TCP传输控制协议，UDP用户数据报协议。TCP提供了高可靠性的端到端的通信。UDP并不保证数据报到达另一台主机，可靠性由应用层提供。</p> <p>在TCP/IP协议族中，网络层IP提供的是一种不可靠的服务。也就是说，它只是尽可能快地把分组从源结点送到目的结点，但是并不提供任何可靠性保证。而另一方面，TCP在不可靠的IP层上提供了一个可靠的运输层。为了提供这种可靠的服务，TCP用了超时重传、发送和接收端到端的确认分组等机制。由此可见，运输层和网络层分别负责不同的功能。网桥是在链路层上对网络进行互连，而路由器则是在网络层上对网络进行互连。TCP和UDP是两种最为著名的运输层协议，二者都使用IP作为网络层协议。</p> <p>4）应用层。负责特定的应用程序细节。</p> <h3 id="_1-3互联网的地址"><a href="#_1-3互联网的地址" class="header-anchor">#</a> 1.3互联网的地址</h3> <p>ABCDE五类</p> <h3 id="_1-5-域名系统"><a href="#_1-5-域名系统" class="header-anchor">#</a> 1.5 域名系统</h3> <p>DNS是一个分布的数据库，提供ip与主机名之间的映射。</p> <h3 id="_1-9-端口"><a href="#_1-9-端口" class="header-anchor">#</a> 1.9 端口</h3> <p>客户端通常对它所使用的端口号并不关心，只需保证该端口号在本机上是唯一的就可以了。</p> <h3 id="_1-13-互联网"><a href="#_1-13-互联网" class="header-anchor">#</a> 1.13 互联网</h3> <p>intetnet意思是用一个共同的协议族把多个网络连接在一起。而 Internet指的是世界范围内通过TCP/CP互相通信的所有主机集合（超过100万台）。Internet是一个internet，但internet不等于Internet。</p> <h3 id="_1-15-应用编程接口"><a href="#_1-15-应用编程接口" class="header-anchor">#</a> 1.15 应用编程接口</h3> <p>使用TCP/CP协议的应用程序通常采用两种应用编程接口（API）：socket和TLI。</p> <h3 id="_1-17-小结"><a href="#_1-17-小结" class="header-anchor">#</a> 1.17 小结</h3> <p>TCP/IP协议族分为四层：链路层、网络层、运输层和应用层，每一层各有不同的责任。</p> <p>在TCP/IP中，网络层和运输层之间的区别是最为关键的：网络层（IP）提供点到点的服务， 而运输层（TCP和UDP）提供端到端的服务。</p> <p>一个互联网是网络的网络。构造互联网的共同基石是路由器，它们在IP层把网络连在一起。第一个字母大写的Internet是指分布在世界各地的大型互联网，其中包括1万多个网络和超过100万台主机。</p> <p>在一个互联网上，每个接口都用IP地址来标识，尽管用户习惯使用主机名而不是IP地址。域名系统为主机名和IP地址之间提供动态的映射。端口号用来标识互相通信的应用程序。服 务器使用知名端口号，而客户使用临时设定的端口号。</p> <h2 id="tcp-ip详解卷一-chapter2-链路层"><a href="#tcp-ip详解卷一-chapter2-链路层" class="header-anchor">#</a> TCP/IP详解卷一 Chapter2 链路层</h2> <h3 id="_2-1-引言"><a href="#_2-1-引言" class="header-anchor">#</a> 2.1 引言</h3> <h4 id="链路层存在的三个目的"><a href="#链路层存在的三个目的" class="header-anchor">#</a> 链路层存在的三个目的</h4> <ul><li>为IP模块发送和接收数据报</li> <li>为ARP模块发送ARP请求和接收ARP应答</li> <li>为RARP发送RARP和接收RARP应答</li></ul> <h3 id="_2-2-以太网和ieee-802封装"><a href="#_2-2-以太网和ieee-802封装" class="header-anchor">#</a> 2.2 以太网和IEEE 802封装</h3> <h4 id="以太网-带冲突检测的载波侦听多路接入-采用csma-cd接入方法。"><a href="#以太网-带冲突检测的载波侦听多路接入-采用csma-cd接入方法。" class="header-anchor">#</a> 以太网：带冲突检测的载波侦听多路接入，采用CSMA/CD接入方法。</h4> <h4 id="ieee-802公布了一个标准集-802-3-802-4-802-5的共同特性由802-2标准来定义-即802共有的llc。"><a href="#ieee-802公布了一个标准集-802-3-802-4-802-5的共同特性由802-2标准来定义-即802共有的llc。" class="header-anchor">#</a> IEEE 802公布了一个标准集，802.3/802.4/802.5的共同特性由802.2标准来定义，即802共有的LLC。</h4> <p>802.3 针对CSMA/CD网络
802.4 针对令牌总线网络
802.5 针对令牌环网络
<img src="/assets/img/httpip_005.361fd6d9.png" alt="http-ip-005"></p> <p>CRC字段用于帧内后续字节差错的循环冗余码校验（校验和）（它也被称为FCS或帧检验序列）</p> <h4 id="ieee-802-与以太网的封装格式有所不同。"><a href="#ieee-802-与以太网的封装格式有所不同。" class="header-anchor">#</a> IEEE 802 与以太网的封装格式有所不同。</h4> <h3 id="_2-3-尾部封装"><a href="#_2-3-尾部封装" class="header-anchor">#</a> 2.3 尾部封装</h3> <h4 id="rfc-893"><a href="#rfc-893" class="header-anchor">#</a> RFC 893</h4> <ul><li>一种用于以太网的封装格式，称作尾部封装。</li></ul> <h3 id="_2-4-slip-串行线路ip"><a href="#_2-4-slip-串行线路ip" class="header-anchor">#</a> 2.4 SLIP：串行线路IP</h3> <h5 id="slip-serial-line-ip-在串行线路上对ip数据报进行封装的简单形式。以这种协议定义的帧格式的ip数据报以end-0xc0-的特殊字符结束。"><a href="#slip-serial-line-ip-在串行线路上对ip数据报进行封装的简单形式。以这种协议定义的帧格式的ip数据报以end-0xc0-的特殊字符结束。" class="header-anchor">#</a> SLIP：Serial Line IP，在串行线路上对IP数据报进行封装的简单形式。以这种协议定义的帧格式的IP数据报以END（0xc0）的特殊字符结束。</h5> <h3 id="_2-5-压缩的slip"><a href="#_2-5-压缩的slip" class="header-anchor">#</a> 2.5 压缩的SLIP</h3> <h4 id="串行线路速率较低、通信是交互式的-为了传输一个数据需要20个字节的ip首部和tcp首部-总数超过40个字节。由于性能存在缺陷-人们提出了cslip的新协议-能将40个字节进行压缩。"><a href="#串行线路速率较低、通信是交互式的-为了传输一个数据需要20个字节的ip首部和tcp首部-总数超过40个字节。由于性能存在缺陷-人们提出了cslip的新协议-能将40个字节进行压缩。" class="header-anchor">#</a> 串行线路速率较低、通信是交互式的，为了传输一个数据需要20个字节的IP首部和TCP首部，总数超过40个字节。由于性能存在缺陷，人们提出了CSLIP的新协议，能将40个字节进行压缩。</h4> <h3 id="_2-6-ppp-点对点协议"><a href="#_2-6-ppp-点对点协议" class="header-anchor">#</a> 2.6 PPP ：点对点协议</h3> <h4 id="ppp点对点协议修复了slip协议中所有的缺陷。ppp包括"><a href="#ppp点对点协议修复了slip协议中所有的缺陷。ppp包括" class="header-anchor">#</a> PPP点对点协议修复了SLIP协议中所有的缺陷。PPP包括：</h4> <ul><li>在串行线路上封装IP数据报的方法。</li> <li>建立、配置及测试数据链路的链路控制协议。</li> <li>针对不同网络层的网络控制协议。</li></ul> <p><img src="/assets/img/httpip_006.a4e54881.png" alt="http-ip-006"></p> <p>总的来说， PPP比SLIP具有下面这些优点：
(1) PPP支持在单根串行线路上运行多种协议，不只是I P协议；
(2) 每一帧都有循环冗余检验；
(3) 通信双方可以进行IP地址的动态协商(使用IP网络控制协议)；
(4) 与CSLIP类似，对TCP和IP报文首部进行压缩；
(5) 链路控制协议可以对多个数据链路选项进行设置。为这些优点付出的代价是在每一帧的首部增加 3个字节，当建立链路时要发送几帧协商数据，以及更为复杂的实现。</p> <h3 id="_2-7-环回接口"><a href="#_2-7-环回接口" class="header-anchor">#</a> 2.7 环回接口</h3> <h4 id="允许运行在同一台主机上的客户程序和服务器程序通过tcp-ip进行通信。"><a href="#允许运行在同一台主机上的客户程序和服务器程序通过tcp-ip进行通信。" class="header-anchor">#</a> 允许运行在同一台主机上的客户程序和服务器程序通过TCP/IP进行通信。</h4> <h4 id="访问环回接口的可以通过特殊的环回地址-一般为127-0-0-1"><a href="#访问环回接口的可以通过特殊的环回地址-一般为127-0-0-1" class="header-anchor">#</a> 访问环回接口的可以通过特殊的环回地址，一般为127.0.0.1</h4> <h3 id="_2-8-最大传输单元mtu"><a href="#_2-8-最大传输单元mtu" class="header-anchor">#</a> 2.8 最大传输单元MTU</h3> <h4 id="mtu称为最大传输单元。"><a href="#mtu称为最大传输单元。" class="header-anchor">#</a> MTU称为最大传输单元。</h4> <h4 id="如果ip数据的长度比链路层的mtu还要大-那么ip层就需要进行分片-将数据拆分成若干片-这样每一片都小于mtu。"><a href="#如果ip数据的长度比链路层的mtu还要大-那么ip层就需要进行分片-将数据拆分成若干片-这样每一片都小于mtu。" class="header-anchor">#</a> 如果IP数据的长度比链路层的MTU还要大，那么IP层就需要进行分片，将数据拆分成若干片，这样每一片都小于MTU。</h4> <h3 id="_2-9-路径mtu"><a href="#_2-9-路径mtu" class="header-anchor">#</a> 2.9 路径MTU</h3> <h4 id="两台通信主机路径中的最小mtu。不一定为常数-取决于当时所选择的路由。"><a href="#两台通信主机路径中的最小mtu。不一定为常数-取决于当时所选择的路由。" class="header-anchor">#</a> 两台通信主机路径中的最小MTU。不一定为常数，取决于当时所选择的路由。</h4> <h2 id="tcp-ip详解卷一-chapter3-ip-网际协议"><a href="#tcp-ip详解卷一-chapter3-ip-网际协议" class="header-anchor">#</a> TCP/IP详解卷一 Chapter3 IP:网际协议</h2> <h3 id="_3-1-引言"><a href="#_3-1-引言" class="header-anchor">#</a> 3.1 引言</h3> <p>IP是TCP/IP协议族中最为核心的协议。所有的TCP、UDP、ICMP及IGMP数据都以IP数据报格式传输。</p> <p>IP仅提供最好的传输服务。任何要求的可靠性必须由上层来提供（如TCP）。</p> <p>无连接：IP并不维护任何关于后续数据报的状态信息。</p> <p>每个数据报的处理是相互独立的。</p> <h3 id="_3-2-ip首部"><a href="#_3-2-ip首部" class="header-anchor">#</a> 3.2 IP首部</h3> <p>普通IP首部长为20个字节，除非含有选项字段。P24</p> <p>目前协议版本号是4，所以IP也称为IPv4。</p> <p>每一份IP数据报都包含源IP地址和目的IP地址。</p> <p><img src="/assets/img/httpip_007.4a37ab41.png" alt="http-ip-007"></p> <p><img src="/assets/img/httpip_008.10eb4dcc.png" alt="http-ip-008"></p> <h3 id="_3-3-ip路由选择"><a href="#_3-3-ip路由选择" class="header-anchor">#</a> 3.3 IP路由选择</h3> <p>路由表中的每一项包含以下信息：</p> <ul><li>目的IP地址</li> <li>下一站路由器的IP地址，或者有直接连接的网络IP地址。</li> <li>标志</li> <li>为数据报的传输</li></ul> <p>IP路由是逐跳进行的。</p> <p>IP路由选择过程：</p> <p><img src="/assets/img/httpip_009.4c4123ac.png" alt="http-ip-009"></p> <h3 id="_3-5-子网掩码"><a href="#_3-5-子网掩码" class="header-anchor">#</a> 3.5 子网掩码</h3> <p>除了IP地址外，主机还需要知道有多少bit用于子网号及多少bit用于主机号。</p> <p>子网掩码：值为1的比特留给网络号和子网号，为0的留给主机号。</p> <p>IP地址一般以点分十进制方法表示，但是子网掩码却经常用十六进制来表示，特别是当界限不是一个字节时，因为子网掩码是一个比特掩码。</p> <p><img src="/assets/img/httpip_010.9c730f6b.png" alt="http-ip-010"></p> <h3 id="_3-8-ifconfig-命令"><a href="#_3-8-ifconfig-命令" class="header-anchor">#</a> 3.8 ifconfig 命令</h3> <p>ifconfig一般在引导的时候运行，以配置主机上的每个接口。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>// 所有接口
<span class="token function">ifconfig</span> <span class="token parameter variable">-a</span>
// 某一接口
<span class="token function">ifconfig</span> eth0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="/assets/img/httpip_011.6403ef77.png" alt="http-ip-011"></p> <h3 id="_3-9-netstat-命令"><a href="#_3-9-netstat-命令" class="header-anchor">#</a> 3.9 netstat 命令</h3> <p>netstat命令也提供系统上的接口信息。-i参数将打印出接口信息，-n参数则打印出IP地址，而不是主机名字。</p> <p><img src="/assets/img/httpip_012.633ab6f7.png" alt="http-ip-012"></p> <h2 id="tcp-ip详解卷一-chapter4-arp-地址解析协议"><a href="#tcp-ip详解卷一-chapter4-arp-地址解析协议" class="header-anchor">#</a> TCP/IP详解卷一 Chapter4 ARP:地址解析协议</h2> <h3 id="_4-1-引言"><a href="#_4-1-引言" class="header-anchor">#</a> 4.1 引言</h3> <p>ARP为IP地址到对应的硬件地址之间提供动态映射。
RARP是被那些没有磁盘驱动器的系统使用，它需要系统管理员进行手工设置。</p> <p><img src="/assets/img/httpip_013.0bffd185.png" alt="http-ip-013"></p> <h3 id="_4-2-一个例子"><a href="#_4-2-一个例子" class="header-anchor">#</a> 4.2 一个例子</h3> <p>ARP会发送一份被称作ARP请求的以太网数据帧给以太网上的每个主机。</p> <p>TCP/IP有自己的地址：32bit的IP地址。知道主机的IP地址并不能让内核发送一帧数据给主机。内核（如以太网驱动程序）必须知道目的端的硬件地址才能发送数据。ARP的功能是在32bit的IP地址和采用不同网络技术的硬件地址之间提供动态映射。</p> <h3 id="_4-3-arp高速缓存"><a href="#_4-3-arp高速缓存" class="header-anchor">#</a> 4.3 ARP高速缓存</h3> <p>ARP高速缓存存放了最近Internet地址到硬件地址之间的映射记录。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>arp <span class="token parameter variable">-a</span>  // 显示所有高速缓存中的内容
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="data:image/png;base64,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" alt="http-ip-014"></p> <h3 id="_4-4-arp的分组格式"><a href="#_4-4-arp的分组格式" class="header-anchor">#</a> 4.4 ARP的分组格式</h3> <p><img src="/assets/img/httpip_015.59a13402.png" alt="http-ip-015"></p> <p>对一个ARP请求来说，除目的端硬件地址外的所有其他的字段都有填充值。</p> <p><img src="/assets/img/httpip_016.f36fb55e.png" alt="http-ip-016"></p> <h3 id="_4-6-arp代理"><a href="#_4-6-arp代理" class="header-anchor">#</a> 4.6 ARP代理</h3> <p>如果ARP请求是从一个网络的主机发往另一个网络的主机，那么连接这两个网络的路由器就可以回答该请求，这个过程称作委托ARP或者ARP代理。</p> <h3 id="_4-7-免费arp"><a href="#_4-7-免费arp" class="header-anchor">#</a> 4.7 免费ARP</h3> <p>免费ARP：主机发送ARP查询自己的IP地址。</p> <p>免费ARP的两个作用：
（1）一个主机可以通过它来确定另一个主机是否设置了相同的IP地址。
（2）如果发送免费 ARP的主机正好改变了硬件地址（很可能是主机关机了，并换了一块接口卡，然后重新启动），那么这个分组就可以使其他主机高速缓存中旧的硬件地址进行相应的更新。</p> <h3 id="_4-8-arp命令"><a href="#_4-8-arp命令" class="header-anchor">#</a> 4.8 ARP命令</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>arp <span class="token parameter variable">-a</span> // 显示ARP高速缓存中的所有内容
arp <span class="token parameter variable">-d</span> // 删除ARP高速缓存中的某一项内容
arp <span class="token parameter variable">-s</span> // 增加高速缓存中的内容
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="tcp-ip详解卷一-chapter5-rarp-逆地址解析协议"><a href="#tcp-ip详解卷一-chapter5-rarp-逆地址解析协议" class="header-anchor">#</a> TCP/IP详解卷一 Chapter5 RARP:逆地址解析协议</h2> <h3 id="_5-1-引言"><a href="#_5-1-引言" class="header-anchor">#</a> 5.1 引言</h3> <p>无盘系统的RARP实现过程是从接口卡上读取唯一的硬件地址，然后发送一份RARP请求（一帧在网络上广播的数据），请求某个主机响应该无盘系统的IP地址。</p> <h3 id="_5-2-rarp的分组格式"><a href="#_5-2-rarp的分组格式" class="header-anchor">#</a> 5.2 RARP的分组格式</h3> <p>RARP分组格式与ARP分组基本一致。
RARP请求或应答的帧类型代码为0x8035。
RAPR请求以广播方式传送，而RARP应答一般是单播传送的。</p> <h3 id="_5-3-rarp举例"><a href="#_5-3-rarp举例" class="header-anchor">#</a> 5.3 RARP举例</h3> <p>当无盘系统从RARP应答中收到它的IP地址后，它将发送 TFTP请求来读取引导映象。</p> <h3 id="_5-4-rarp服务器的设计"><a href="#_5-4-rarp服务器的设计" class="header-anchor">#</a> 5.4 RARP服务器的设计</h3> <p>内核知道IP地址和硬件地址，当它收到一个询问IP地址的ARP请求时，只需用相应的硬件地址来提供应答。
发送和接收数据帧与系统有关，因此，RARP服务器的实现是与系统捆绑在一起的。
发送RARP请求的无盘系统一般采用最先收到的RARP应答。</p> <h3 id="_5-5-小结"><a href="#_5-5-小结" class="header-anchor">#</a> 5.5 小结</h3> <p>RARP协议是许多无盘系统在引导时用来获取IP地址的。
RARP分组格式基本上与 ARP分组一致。
一个RARP请求在网络上进行广播，它在分组中标明发送端的硬件地址，以请求相应IP地址的响应。应答通常是单播传送的。</p> <h2 id="tcp-ip详解卷一-chapter7-ping程序"><a href="#tcp-ip详解卷一-chapter7-ping程序" class="header-anchor">#</a> TCP/IP详解卷一 Chapter7 Ping程序</h2> <h3 id="_7-1-引言"><a href="#_7-1-引言" class="header-anchor">#</a> 7.1 引言</h3> <p>Ping程序用于测试另一台主机是否可达。</p> <h3 id="_7-2-ping程序"><a href="#_7-2-ping程序" class="header-anchor">#</a> 7.2 Ping程序</h3> <p>ICMP回显请求和回显应答报文格式：
<img src="/assets/img/httpip_017.2fcdaf1a.png" alt="http-ip-017">
Unix系统在实现ping程序时是把 ICMP报文中的标识符字段置成发送进程的ID号。这样即使在同一台主机上同时运行了多个ping程序实例，ping程序也可以识别出返回的信息。
序列号从0开始，每发送一次新的回显请求就加 1。 ping程序打印出返回的每个分组的序列号，允许我们查看是否有分组丢失、失序或重复。
<img src="/assets/img/httpip_018.d98778c0.png" alt="http-ip-018"></p> <h3 id="_7-3-ip记录路由选项"><a href="#_7-3-ip记录路由选项" class="header-anchor">#</a> 7.3 IP记录路由选项</h3> <p>-R： 记录路由
<img src="/assets/img/httpip_019.2f1a646f.png" alt="http-ip-019"> <img src="/assets/img/httpip_020.d940f2a8.png" alt="http-ip-020"></p> <h3 id="_7-4-ip时间戳选项"><a href="#_7-4-ip时间戳选项" class="header-anchor">#</a> 7.4 IP时间戳选项</h3> <p><img src="/assets/img/httpip_021.db9472b6.png" alt="http-ip-021"></p> <h3 id="_7-5-小结"><a href="#_7-5-小结" class="header-anchor">#</a> 7.5 小结</h3> <p>ping程序是对两个TCP/IP系统连通性进行测试的基本工具。
它只利用ICMP回显请求和回显应答报文，而不经过传输层（TCP/UDP）。</p> <h2 id="tcp-ip详解卷一-chapter17-tcp-传输控制协议"><a href="#tcp-ip详解卷一-chapter17-tcp-传输控制协议" class="header-anchor">#</a> TCP/IP详解卷一 Chapter17 TCP:传输控制协议</h2> <h3 id="_17-2-tcp的服务"><a href="#_17-2-tcp的服务" class="header-anchor">#</a> 17.2 TCP的服务</h3> <p>TCP提供一组面向连接的、可靠的字节流服务。
TCP对字节流的内容不作任何解释。对字节流的解释由TCP连接双方的应用层解释。
TCP的可靠性保证：
<img src="/assets/img/httpip_022.4215d2cd.png" alt="http-ip-022"></p> <h3 id="_17-3-tcp的首部"><a href="#_17-3-tcp的首部" class="header-anchor">#</a> 17.3 TCP的首部</h3> <p>TCP数据被封装在一个IP数据报中。
<img src="/assets/img/httpip_001.b8bc632b.png" alt="http-ip-001">
TCP首部通常是20字节。
<img src="/assets/img/httpip_002.6fbbe8a5.png" alt="http-ip-002">
IP首部的源端IP地址和目的端IP地址，以及TCP首部的源端口号和目的端端口号唯一确定一个TCP连接。
一个IP地址和一个端口号也称为一个插口（socket）。
插口对（socket pair）（包含客户IP地址、客户端口号、服务器IP地址和服务器端口号的四元祖）可唯一确定互联网络中的每个TCP连接的双方。
确认序号应当是上次已成功收到数据字节序号加1。
TCP为应用层提供全双工服务。
TCP首部中的6个标志比特：</p> <table><thead><tr><th>标志位</th> <th>意义</th></tr></thead> <tbody><tr><td>URG</td> <td>紧急指针</td></tr> <tr><td>ACK</td> <td>确认序号有效</td></tr> <tr><td>PSH</td> <td>接收方应该尽快将这个报文段交给应用层</td></tr> <tr><td>PST</td> <td>重建连接</td></tr> <tr><td>SYN</td> <td>同步序号用来发送一个连接</td></tr> <tr><td>FIN</td> <td>发端完成发送任务</td></tr></tbody></table> <p>TCP的流量控制由连接的每一端通过声明的窗口来提供。
检验和覆盖了整个的TCP报文段：TCP首部和TCP数据。这是一个强制性的字段，一定是由发端计算和存储，并由收端进行验证。
最常见的可选字段是最长报文大小，又称为MSS(Maximum Segment Size)。</p> <h3 id="_17-4-小结"><a href="#_17-4-小结" class="header-anchor">#</a> 17.4 小结</h3> <p>TCP提供了一种可靠的面向连接的字节流运输层服务。
TCP将用户数据打包构成报文段；它发送数据后启动一个定时器；另一端对收到的数据进行确认，对失序的数据重新排序，丢弃重复数据；TCP提供端到端的流量控制，并计算和验证一个强制性的端到端校验和。</p> <h2 id="tcp-ip详解卷一-chapter18-tcp连接的建立与终止"><a href="#tcp-ip详解卷一-chapter18-tcp连接的建立与终止" class="header-anchor">#</a> TCP/IP详解卷一 Chapter18 TCP连接的建立与终止</h2> <h3 id="_18-1-引言"><a href="#_18-1-引言" class="header-anchor">#</a> 18.1 引言</h3> <p>TCP是面向连接的协议。无论哪一方向另一方发送数据之前，都必须先在双方之间建立一条连接。</p> <h3 id="_18-2-连接的建立与终止"><a href="#_18-2-连接的建立与终止" class="header-anchor">#</a> 18.2 连接的建立与终止</h3> <p><img src="/assets/img/httpip_023.6ffd9c9c.png" alt="httpip_023">
源&gt;目的：标志
win表示发端通告的窗口大小
mss表示发端指明的最大报文段长度选项</p> <p><strong>3次握手，建立连接协议</strong>：
step1：请求端发送一个SYN段指明客户打算连接的服务器的端口，以及初始序号（ISN）。这个SYN段为报文段1。
step2：服务器发回包含服务器的初始序号的SYN报文段（报文段2）作为应答。同时，将确认序号设置为客户的ISN加1以客户的SYN报文段进行确认。
step3：客户必须将确认序号设置为服务器的ISN加1以对服务器的SYN报文段进行确认（报文段3）。
<img src="/assets/img/httpip_003.3f1e1623.png" alt="httpip_003"></p> <p><strong>4次挥手，连接终止协议</strong>：
当服务器收到这个FIN，它发回一个ACK，确认序号为收到的序号加1。和SYN一样，一个FIN将占用一个序号。同时TCP服务器还向应用程序（即丢弃服务器）传送一个文件结束符。接着这个服务器程序就关闭它的连接，导致它的TCP端发送一个FIN，客户必须发回一个确认，并将确认序号设置为收到序号加1。
<img src="/assets/img/httpip_004.9e432b71.png" alt="image-20201109161904953"></p> <h3 id="_18-3-连接建立的超时"><a href="#_18-3-连接建立的超时" class="header-anchor">#</a> 18.3 连接建立的超时</h3> <h3 id="_18-4-最大报文段长度"><a href="#_18-4-最大报文段长度" class="header-anchor">#</a> 18.4 最大报文段长度</h3> <p>最大报文段长度（MSS）表示TCP传往另一端的最大块数据的长度。当一个连接建立时，连接的双方都要通告各自的MSS。</p> <h3 id="_18-5-tcp的半关闭"><a href="#_18-5-tcp的半关闭" class="header-anchor">#</a> 18.5 TCP的半关闭</h3> <p>半关闭：TCP提供了连接的一端在结束它的发送后还能接收来自另一端数据的能力。</p> <h3 id="_18-6-tcp的状态变迁图"><a href="#_18-6-tcp的状态变迁图" class="header-anchor">#</a> 18.6 TCP的状态变迁图</h3> <p><img src="/assets/img/httpip_025.17fda431.png" alt="httpip_025"> <strong>2MSL等待时间</strong>：
TIME_WAIT状态也称为2MSL等待状态。每个具体TCP实现必须选择一个报文段最大生存时间MSL（Maximum Segment Lifetime）。它是任何报文段被丢弃前在网络内的最长时间。</p> <h3 id="_18-7-复位报文段"><a href="#_18-7-复位报文段" class="header-anchor">#</a> 18.7 复位报文段</h3> <p>RST用于复位。</p> <h3 id="_18-8-同时打开"><a href="#_18-8-同时打开" class="header-anchor">#</a> 18.8 同时打开</h3> <p>TCP是特意设计为了可以处理同时打开，对于同时打开它仅建立一条连接而不是两条连接（其他的协议族，最突出的是 OSI运输层，在这种情况下将建立两条连接而不是一条连接）。
<img src="/assets/img/httpip_026.dd5efe70.png" alt="httpip_026"></p> <h3 id="_18-9-同时关闭"><a href="#_18-9-同时关闭" class="header-anchor">#</a> 18.9 同时关闭</h3> <p><img src="/assets/img/httpip_027.3ca01c93.png" alt="httpip_027"></p> <h3 id="_18-10-tcp选项"><a href="#_18-10-tcp选项" class="header-anchor">#</a> 18.10 TCP选项</h3> <h3 id="_18-11-tcp服务的设计"><a href="#_18-11-tcp服务的设计" class="header-anchor">#</a> 18.11 TCP服务的设计</h3> <h3 id="_18-12-小结"><a href="#_18-12-小结" class="header-anchor">#</a> 18.12 小结</h3> <p>两个进程在进行TCP交换数据之前，必须建立一条连接。
三次握手。
四次挥手。
一个TCP连接由一个4元组唯一确定：本地IP地址、本地端口号、远端IP地址和远端端口号。</p> <h2 id="tcp-ip详解卷一-chapter19-tcp的交互数据流"><a href="#tcp-ip详解卷一-chapter19-tcp的交互数据流" class="header-anchor">#</a> TCP/IP详解卷一 Chapter19 TCP的交互数据流</h2> <h3 id="_19-1-引言"><a href="#_19-1-引言" class="header-anchor">#</a> 19.1 引言</h3> <p>成块数据的报文段基本上是满长度的（通常为512字节）。
交互数据小得多（小于10个字节）。
TCP需要同时处理这两类数据。</p> <h3 id="_19-2-交互式输入"><a href="#_19-2-交互式输入" class="header-anchor">#</a> 19.2 交互式输入</h3> <h3 id="_19-3-经受时延的确认"><a href="#_19-3-经受时延的确认" class="header-anchor">#</a> 19.3 经受时延的确认</h3> <p>通常TCP在接收到数据时并不立即发送ACK；相反，它推迟发送，以便将 ACK与需要沿该方向发送的数据一起发送（有时称这种现象为数据捎带A CK）。绝大多数实现采用的时延为200 ms，也就是说，TCP将以最大200 ms 的时延等待是否有数据一起发送。</p> <h3 id="_19-4-nagle算法"><a href="#_19-4-nagle算法" class="header-anchor">#</a> 19.4 Nagle算法</h3> <p>该算法要求一个TCP连接上最多只能有一个未被确认的未完成的小分组，在该分组的确认到达之前不能发送其他的小分组。</p> <h3 id="_19-5-窗口大小通告"><a href="#_19-5-窗口大小通告" class="header-anchor">#</a> 19.5 窗口大小通告</h3> <h3 id="_19-6-小结"><a href="#_19-6-小结" class="header-anchor">#</a> 19.6 小结</h3> <ul><li>交互数据总是以小于最大报文段长度的分组发送。</li> <li>对于小的报文段，接收方使用经受时延的确认方法来判断确认是否可被推迟发送，以便与回送数据一起发送。这样会减少报文段的数目。</li> <li>在较慢的广域网环境中，通常使用Nagle算法减少小报文段的数量。这个算法限制发送者任何时候只能有一个发送的小报文段未被确认。</li></ul> <h2 id="tcp-ip详解卷一-chapter20-tcp的成块数据流"><a href="#tcp-ip详解卷一-chapter20-tcp的成块数据流" class="header-anchor">#</a> TCP/IP详解卷一 Chapter20 TCP的成块数据流</h2> <h3 id="_20-1-引言"><a href="#_20-1-引言" class="header-anchor">#</a> 20.1 引言</h3> <p>本章介绍一种流量控制方法：滑动窗口协议。</p> <p>该协议允许发送方在停止并等待确认前可以连续发送多个分组。</p> <p>由于发送方不必每发一个分组就停下来等待确认，因此该协议可以加速数据的传输。</p> <h3 id="_20-2-正常数据流"><a href="#_20-2-正常数据流" class="header-anchor">#</a> 20.2 正常数据流</h3> <p>使用TCP的滑动窗口协议时，接收方不必确认每一个收到的分组。在TCP中，ACK是累积的—它们表示接收方已经正确收到了一直到确认序号减 1的所有字节。</p> <h3 id="_20-3-滑动窗口"><a href="#_20-3-滑动窗口" class="header-anchor">#</a> 20.3 滑动窗口</h3> <h3 id="_20-4-窗口大小"><a href="#_20-4-窗口大小" class="header-anchor">#</a> 20.4 窗口大小</h3> <h3 id="_20-5-push标志"><a href="#_20-5-push标志" class="header-anchor">#</a> 20.5 PUSH标志</h3> <p><strong>PUSH标志</strong>：
发送方使用
该标志通知接收方将所收到的数据全部提交给接收进程。这里的数据包括与PUSH一起传送的数据以及接收方TCP已经为接收进程收到的其他数据。</p> <h3 id="_20-6-慢启动"><a href="#_20-6-慢启动" class="header-anchor">#</a> 20.6 慢启动</h3> <p>慢启动 (slow start)：
该算法通过观察到新分组进入网络的速率应该与另一端返回确认的速率相同而进行工作。</p> <p>慢启动为发送方的TCP增加了另一个窗口：拥塞窗口 (congestion window)，记为cwnd。当与另一个网络的主机建立 TCP连接时，拥塞窗口被初始化为 1个报文段（即另一端通告的报文段大小）。每收到一个 A C K，拥塞窗口就增加一个报文段（cwnd以字节为单位，但是慢启动以报文段大小为单位进行增加）。</p> <p>发送方取拥塞窗口与通告窗口中的最小值作为发送上限。拥塞窗口是发送方使用的流量控制，而通告窗口则是接收方使用的流量控制。</p> <h3 id="_20-7-成块数据的吞吐量"><a href="#_20-7-成块数据的吞吐量" class="header-anchor">#</a> 20.7 成块数据的吞吐量</h3> <p>当数据到达一个大的管道（如一个快速局域网）并向一个较小的管道（如一个较慢的广域网）发送时便会发生拥塞。当多个输入流到达一个路由器，而路由器的输出流小于这些输入流的总和时也会发生拥塞。</p> <h3 id="_20-8-紧急方式"><a href="#_20-8-紧急方式" class="header-anchor">#</a> 20.8 紧急方式</h3> <p>TCP提供了“紧急方式 ( urgent mode) ”，它使一端可以告诉另一端有些具有某种方式的“紧急数据”已经放置在普通的数据流中。另一端被通知这个紧急数据已被放置在普通数据流中，由接收方决定如何处理。</p> <p>URG比特被置1，并且一个 16bit的紧急指针被置为一个正的偏移量，该偏移量必须与TCP首部中的序号字段相加，以便得出紧急数据的最后一个字节的序号。</p> <h3 id="_20-9-小结"><a href="#_20-9-小结" class="header-anchor">#</a> 20.9 小结</h3> <p>进行成块数据有效传输的最重要的方法是TCP的滑动窗口协议。</p> <h2 id="tcp-ip详解卷一-chapter21-tcp的超时与重传"><a href="#tcp-ip详解卷一-chapter21-tcp的超时与重传" class="header-anchor">#</a> TCP/IP详解卷一 Chapter21 TCP的超时与重传</h2> <h3 id="_21-1-引言"><a href="#_21-1-引言" class="header-anchor">#</a> 21.1 引言</h3> <p>TCP通过在发送时设置一个定时器来解决这种问题。如果当定时器溢出
时还没有收到确认，它就重传该数据。</p> <h3 id="_21-3-往返时间测量"><a href="#_21-3-往返时间测量" class="header-anchor">#</a> 21.3 往返时间测量</h3> <p><img src="/assets/img/httpip_028.412ee7e7.png" alt="httpip_028"></p> <h3 id="_21-6-拥塞避免算法"><a href="#_21-6-拥塞避免算法" class="header-anchor">#</a> 21.6 拥塞避免算法</h3> <p>慢启动算法是在一个连接上发起数据流的方法，但有时我们会达到中间
路由器的极限，此时分组将被丢弃。拥塞避免算法是一种处理丢失分组的方法。</p> <p>拥塞避免算法和慢启动算法需要对每个连接维持两个变量：一个拥塞窗口 cwnd和一个慢启动门限ssthresh。P235</p> <p><img src="/assets/img/httpip_029.2018c3a0.png" alt="httpip_029"></p> <h3 id="_21-7-快速重传与快速恢复算法"><a href="#_21-7-快速重传与快速恢复算法" class="header-anchor">#</a> 21.7 快速重传与快速恢复算法</h3> <p>算法步骤：</p> <ol><li>当收到第3个重复的ACK时，将ssthresh设置为当前拥塞窗口cwnd的一半。重传丢失的
报文段。设置cwnd为ssthresh加上3倍的报文段大小。</li> <li>每次收到另一个重复的 ACK时， cwnd增加1个报文段大小并发送 1个分组（如果新的cwnd允许发送）。</li> <li>当下一个确认新数据的 ACK到达时，设置cwnd为ssthresh（在第1步中设置的值）。这个ACK应该是在进行重传后的一个往返时间内对步骤 1中重传的确认。另外，这个 ACK也应该是对丢失的分组和收到的第 1个重复的ACK之间的所有中间报文段的确认。这一步采用的是拥塞避免，因为当分组丢失时我们将当前的速率减半。</li></ol> <h3 id="_21-11-重新分组"><a href="#_21-11-重新分组" class="header-anchor">#</a> 21.11 重新分组</h3> <p>当TCP超时并重传时，它不一定要重传同样的报文段。相反，TCP允许进行重新分组而发送一个较大的报文段，这将有助于提高性能。</p> <h3 id="_21-12-小结"><a href="#_21-12-小结" class="header-anchor">#</a> 21.12 小结</h3> <p>慢启动、拥塞避免、快速重传和快速恢复</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">1/17/2021, 7:29:58 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/program/cpp/dataStructure.html" class="prev">
        常用数据结构与算法
      </a></span> <span class="next"><a href="/program/cpp/Ceph.html">
        分布式存储系统Ceph
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.7cef2ded.js" defer></script><script src="/assets/js/2.6425c107.js" defer></script><script src="/assets/js/3.b11b99ee.js" defer></script>
  </body>
</html>
